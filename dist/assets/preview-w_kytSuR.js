import{P as J,Q as N,x as Q,j as G,r as x,o as z,d as L,e as C,g as v,m as K,F as W,s as Y,t as I,R as Z}from"./index-Cq1Zp2HD.js";import{r as $}from"./requestdb-CQ0r-RDs.js";import"./axios-B4uVmeYG.js";var S={exports:{}};/**
 *  PDFObject v2.3.0
 *  https://github.com/pipwerks/PDFObject
 *  @license
 *  Copyright (c) 2008-2024 Philip Hutchison
 *  MIT-style license: http://pipwerks.mit-license.org/
 *  UMD module pattern from https://github.com/umdjs/umd/blob/master/templates/returnExports.js
 */(function(P){(function(h,l){P.exports?P.exports=l():h.PDFObject=l()})(J,function(){if(typeof window>"u"||window.navigator===void 0||window.navigator.userAgent===void 0)return!1;let h="2.3.0",l=window,i=l.navigator,g=i.userAgent,k=!1,c=function(){let e=l.chrome!==void 0,n=l.safari!==void 0||i.vendor!==void 0&&/Apple/.test(i.vendor)&&/Safari/.test(g),o=l.Mozilla!==void 0||/irefox/.test(g);return e||n||o},p=function(e){var n=null;try{n=new ActiveXObject(e)}catch{n=null}return!!n},F=function(){return"ActiveXObject"in l&&(p("AcroPDF.PDF")||p("PDF.PdfCtrl"))},E=function(){if(i.platform!==void 0&&i.platform==="MacIntel"&&i.maxTouchPoints!==void 0&&i.maxTouchPoints>1||/Mobi|Tablet|Android|iPad|iPhone/.test(g))return!1;let o=typeof i.pdfViewerEnabled=="boolean";return o&&!i.pdfViewerEnabled?!1:o&&i.pdfViewerEnabled||c()||F()}(),A=function(e){let n="",o,r=[],t="";if((e.comment||e.viewrect||e.highlight)&&(e.page||(e.page=1,j("The comment, viewrect, and highlight parameters require a page parameter, but none was specified. Defaulting to page 1."))),e.page&&(r.push("page="+encodeURIComponent(e.page)),delete e.page),e.fdf&&(t=e.fdf,delete e.fdf),e){for(o in e)e.hasOwnProperty(o)&&r.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));t&&r.push("fdf="+encodeURIComponent(t)),n=r.join("&"),n&&(n="#"+n)}return n},j=function(e){return k||console.log("[PDFObject]",e),!1},B=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},H=function(e){let n=document.body;return typeof e=="string"?n=document.querySelector(e):l.jQuery!==void 0&&e instanceof jQuery&&e.length?n=e.get(0):e.nodeType!==void 0&&e.nodeType===1&&(n=e),n},V=function(e,n,o,r){if(window.Blob&&window.URL&&window.URL.createObjectURL){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){if(t.status===200){var u=t.response,a=document.createElement("a");a.innerText="Download PDF",a.href=URL.createObjectURL(u),a.setAttribute("download",n),o.innerHTML=r.replace(/\[pdflink\]/g,a.outerHTML)}},t.send()}},O=function(e,n,o,r,t,u,a,T,y,f,w){B(n);let m=o;if(e==="pdfjs"){let d=w.indexOf("?")!==-1?"&":"?";m=w+d+"file="+encodeURIComponent(o)+r}else m+=r;let s=document.createElement("iframe");if(s.className="pdfobject",s.type="application/pdf",s.title=T,s.src=m,s.allow="fullscreen",s.frameborder="0",a&&(s.id=a),!y){let d="border: none;";n!==document.body?d+="width: "+t+"; height: "+u+";":d+="position: absolute; top: 0; right: 0; bottom: 0; left: 0; width: 100%; height: 100%;",s.style.cssText=d}let D=["className","type","title","src","style","id","allow","frameborder"];return f&&f.key&&D.indexOf(f.key)===-1&&s.setAttribute(f.key,typeof f.value<"u"?f.value:""),n.classList.add("pdfobject-container"),n.appendChild(s),n.getElementsByTagName("iframe")[0]},X=function(e,n,o){let r=n||!1,t=o||{};k=typeof t.suppressConsole=="boolean"?t.suppressConsole:!1;let u=typeof t.id=="string"?t.id:"",a=t.page||!1,T=t.pdfOpenParams||{},y=typeof t.fallbackLink=="string"||typeof t.fallbackLink=="boolean"?t.fallbackLink:!0,f=t.width||"100%",w=t.height||"100%",m=t.title||"Embedded PDF",s=typeof t.forcePDFJS=="boolean"?t.forcePDFJS:!1,D=typeof t.omitInlineStyles=="boolean"?t.omitInlineStyles:!1,d=t.PDFJS_URL||!1,b=H(r),_="",R=t.customAttribute||{},U="<p>This browser does not support inline PDFs. Please download the PDF to view it: [pdflink]</p>";if(typeof e!="string")return j("URL is not valid");if(!b)return j("Target element cannot be determined");if(a&&(T.page=a),_=A(T),s&&d)return O("pdfjs",b,e,_,f,w,u,m,D,R,d);if(E)return O("iframe",b,e,_,f,w,u,m,D,R);if(d)return O("pdfjs",b,e,_,f,w,u,m,D,R,d);if(y)if(typeof y=="string")b.innerHTML=y.replace(/\[url\]/g,e);else if(e.indexOf("data:application/pdf;base64")!==-1)V(e,"file.pdf",b,U);else{let q="<a href='"+e+"'>Download PDF</a>";b.innerHTML=U.replace(/\[pdflink\]/g,q)}return j("This browser does not support embedded PDFs")};return{embed:function(e,n,o){return X(e,n,o)},pdfobjectversion:function(){return h}(),supportsPDFs:function(){return E}()}})})(S);var ee=S.exports;const te=N(ee),ne={id:"app"},oe={class:"document"},ie=v("h2",null,"文档内容",-1),le={class:"blocks"},se=v("h2",null,"分块效果",-1),de=Q({__name:"preview",setup(P){const h=G(),l=x([]),i=x(null),g=x(null),k=async()=>{const c=new FormData;c.append("username","admin"),c.append("id",h.params.id),c.append("dconame",h.params.dconame);try{const p=await $.post("/get_chunks",c);l.value=p.data.chunk,i.value=p.data.file_url,i.value&&(await Z(),te.embed(i.value,g.value))}catch(p){console.log("发生错误: "+p.message)}};return z(()=>{k()}),(c,p)=>(L(),C("div",ne,[v("div",oe,[ie,i.value?(L(),C("div",{key:0,ref_key:"pdfContainer",ref:g},null,512)):K("",!0)]),v("div",le,[se,(L(!0),C(W,null,Y(l.value,(F,M)=>(L(),C("div",{key:M,class:"block"},[v("h3",null,"块 "+I(M+1),1),v("p",null,I(F),1)]))),128))])]))}});export{de as default};
