import{x as p,d as v,e as m,_ as g,b as w,p as _}from"./index-Cq1Zp2HD.js";function y(e,n,i,s){function r(t){return t instanceof i?t:new i(function(a){a(t)})}return new(i||(i=Promise))(function(t,a){function u(c){try{o(s.next(c))}catch(l){a(l)}}function d(c){try{o(s.throw(c))}catch(l){a(l)}}function o(c){c.done?t(c.value):r(c.value).then(u,d)}o((s=s.apply(e,[])).next())})}function R(e,n){var i={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},s,r,t,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(o){return function(c){return d([o,c])}}function d(o){if(s)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(i=0)),i;)try{if(s=1,r&&(t=o[0]&2?r.return:o[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,o[1])).done)return t;switch(r=0,t&&(o=[o[0]&2,t.value]),o[0]){case 0:case 1:t=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(t=i.trys,!(t=t.length>0&&t[t.length-1])&&(o[0]===6||o[0]===2)){i=0;continue}if(o[0]===3&&(!t||o[1]>t[0]&&o[1]<t[3])){i.label=o[1];break}if(o[0]===6&&i.label<t[1]){i.label=t[1],t=o;break}if(t&&i.label<t[2]){i.label=t[2],i.ops.push(o);break}t[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(c){o=[6,c],r=0}finally{s=t=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}var E=function(e,n){return y(void 0,void 0,void 0,function(){return R(this,function(i){return[2,new Promise(function(s,r){try{if(window.DocsAPI)return s(null);var t=document.getElementById(n);if(t)var a=setInterval(function(){var d=t.getAttribute("loading");if(!d){if(clearInterval(a),window.DocsAPI)return s(null);var o=f(n,e,s,r);t.remove(),document.body.appendChild(o)}},500);else{var u=f(n,e,s,r);document.body.appendChild(u)}}catch(d){console.error(d)}})]})})},f=function(e,n,i,s){var r=document.createElement("script");return r.id=e,r.type="text/javascript",r.src=n,r.async=!0,r.onload=function(){r.removeAttribute("loading"),i(null)},r.onerror=function(t){r.removeAttribute("loading"),s(t)},r.setAttribute("loading",""),r},h=p({name:"DocumentEditor",props:{id:{type:String,required:!0},documentServerUrl:{type:String,required:!0},config:{type:Object,required:!0},document_fileType:String,document_title:String,documentType:String,editorConfig_lang:String,height:String,type:String,width:String,onLoadComponentError:Function,events_onAppReady:Function,events_onDocumentStateChange:Function,events_onMetaChange:Function,events_onDocumentReady:Function,events_onInfo:Function,events_onWarning:Function,events_onError:Function,events_onRequestSharingSettings:Function,events_onRequestRename:Function,events_onMakeActionLink:Function,events_onRequestInsertImage:Function,events_onRequestSaveAs:Function,events_onRequestMailMergeRecipients:Function,events_onRequestCompareFile:Function,events_onRequestEditRights:Function,events_onRequestHistory:Function,events_onRequestHistoryClose:Function,events_onRequestHistoryData:Function,events_onRequestRestore:Function,events_onRequestSelectSpreadsheet:Function,events_onRequestSelectDocument:Function},mounted:function(){var e=this,n=this.documentServerUrl;n.endsWith("/")||(n+="/");var i="".concat(n,"web-apps/apps/api/documents/api.js");E(i,"onlyoffice-api-script").then(function(){return e.onLoad()}).catch(function(){e.onError(-2)})},unmounted:function(){var e,n=this.id||"";!((e=window==null?void 0:window.DocEditor)===null||e===void 0)&&e.instances[n]&&(window.DocEditor.instances[n].destroyEditor(),window.DocEditor.instances[n]=void 0)},watch:{config:{handler:function(e,n){this.onChangeProps()},deep:!0},document_fileType:function(e,n){this.onChangeProps()},document_title:function(e,n){this.onChangeProps()},documentType:function(e,n){this.onChangeProps()},editorConfig_lang:function(e,n){this.onChangeProps()},height:function(e,n){this.onChangeProps()},type:function(e,n){this.onChangeProps()},width:function(e,n){this.onChangeProps()}},methods:{onLoad:function(){var e,n;try{var i=this.id||"";if(window.DocsAPI||this.onError(-3),!((e=window==null?void 0:window.DocEditor)===null||e===void 0)&&e.instances[i]){console.log("Skip loading. Instance already exists",i);return}!((n=window==null?void 0:window.DocEditor)===null||n===void 0)&&n.instances||(window.DocEditor={instances:{}});var s=Object.assign({document:{fileType:this.document_fileType,title:this.document_title},documentType:this.documentType,editorConfig:{lang:this.editorConfig_lang},events:{onAppReady:this.onAppReady,onDocumentStateChange:this.events_onDocumentStateChange,onMetaChange:this.events_onMetaChange,onDocumentReady:this.events_onDocumentReady,onInfo:this.events_onInfo,onWarning:this.events_onWarning,onError:this.events_onError,onRequestSharingSettings:this.events_onRequestSharingSettings,onRequestRename:this.events_onRequestRename,onMakeActionLink:this.events_onMakeActionLink,onRequestInsertImage:this.events_onRequestInsertImage,onRequestSaveAs:this.events_onRequestSaveAs,onRequestMailMergeRecipients:this.events_onRequestMailMergeRecipients,onRequestCompareFile:this.events_onRequestCompareFile,onRequestEditRights:this.events_onRequestEditRights,onRequestHistory:this.events_onRequestHistory,onRequestHistoryClose:this.events_onRequestHistoryClose,onRequestHistoryData:this.events_onRequestHistoryData,onRequestRestore:this.events_onRequestRestore,onRequestSelectSpreadsheet:this.events_onRequestSelectSpreadsheet,onRequestSelectDocument:this.events_onRequestSelectDocument},height:this.height,type:this.type,width:this.width},this.config||{}),r=window.DocsAPI.DocEditor(i,s);window.DocEditor.instances[i]=r}catch(t){console.error(t),this.onError(-1)}},onError:function(e){var n;switch(e){case-2:n="Error load DocsAPI from "+this.documentServerUrl;break;case-3:n="DocsAPI is not defined";break;default:n="Unknown error loading component",e=-1}typeof this.onLoadComponentError>"u"?console.error(n):this.onLoadComponentError(e,n)},onAppReady:function(){var e=this.id||"";this.events_onAppReady(window.DocEditor.instances[e])},onChangeProps:function(){var e,n=this.id||"";!((e=window==null?void 0:window.DocEditor)===null||e===void 0)&&e.instances[n]&&(window.DocEditor.instances[n].destroyEditor(),window.DocEditor.instances[n]=void 0,console.log("Important props have been changed. Load new Editor."),this.onLoad())}}});const q=["id"];function S(e,n,i,s,r,t){return v(),m("div",{id:e.id},null,8,q)}h.render=S;h.__file="src/components/DocumentEditor.vue";const D=p({name:"ExampleComponent",components:{DocumentEditor:h},data(){return{config:{document:{fileType:"docx",key:"Khirz6zTPdfd7",title:"Example Document Title.docx",url:"https://example.com/url-to-example-document.docx"},documentType:"word",editorConfig:{callbackUrl:"https://example.com/url-to-callback.ashx"}}}},methods:{onDocumentReady(){console.log("Document is loaded")},onLoadComponentError(e,n){switch(e){case-1:console.log(n);break;case-2:console.log(n);break;case-3:console.log(n);break}}}});function C(e,n,i,s,r,t){const a=w("DocumentEditor");return v(),_(a,{id:"docEditor",documentServerUrl:"http://documentserver/",config:e.config,events_onDocumentReady:e.onDocumentReady,onLoadComponentError:e.onLoadComponentError},null,8,["config","events_onDocumentReady","onLoadComponentError"])}const F=g(D,[["render",C]]);export{F as default};
